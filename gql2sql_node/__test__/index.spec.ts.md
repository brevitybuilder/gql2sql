# Snapshot report for `__test__/index.spec.ts`

The actual snapshot is saved in `index.spec.ts.snap`.

Generated by [AVA](https://avajs.dev).

## sync function from native code

> Snapshot 1

    {
      isMutation: false,
      params: null,
      sql: 'SELECT json_build_object(\'App\', (SELECT coalesce(json_agg(to_json((SELECT "root" FROM (SELECT "base"."id", "join.components.57f9bf6390bb3" AS "components") AS "root"))), \'[]\') AS "root" FROM (SELECT * FROM "App" WHERE "id" = \'345810043118026832\' ORDER BY "name" ASC) AS "base" LEFT JOIN LATERAL (SELECT coalesce(json_agg(to_json((SELECT "root" FROM (SELECT "base.Component"."appId", "base.Component"."id", "join.pageMeta.57f9bf6390bb3" AS "pageMeta", "join.elements.5430bbcbfc174" AS "elements") AS "root"))), \'[]\') AS "join.components.57f9bf6390bb3" FROM (SELECT * FROM "Component" WHERE "Component"."appId" = "base"."id") AS "base.Component" LEFT JOIN LATERAL (SELECT to_json((SELECT "root" FROM (SELECT "base.Component.PageMeta"."componentId", "base.Component.PageMeta"."id", "base.Component.PageMeta"."path") AS "root")) AS "join.pageMeta.57f9bf6390bb3" FROM (SELECT * FROM "PageMeta" WHERE "PageMeta"."componentId" = "base.Component"."id" LIMIT 1) AS "base.Component.PageMeta") AS "join.pageMeta.57f9bf6390bb3.PageMeta" ON (\'true\') LEFT JOIN LATERAL (SELECT coalesce(json_agg(to_json((SELECT "root" FROM (SELECT "base.Component.Element"."componentParentId", "base.Component.Element"."id", "base.Component.Element"."name") AS "root"))), \'[]\') AS "join.elements.5430bbcbfc174" FROM (SELECT * FROM "Element" WHERE "Element"."componentParentId" = "base.Component"."id" ORDER BY "order" ASC) AS "base.Component.Element") AS "join.elements.5430bbcbfc174.Element" ON (\'true\')) AS "join.components.57f9bf6390bb3.Component" ON (\'true\')), \'Component_aggregate\', (SELECT json_build_object(\'count\', COUNT(*), \'min\', json_build_object(\'createdAt\', MIN("createdAt"))) AS "root" FROM (SELECT * FROM "Component" WHERE "appId" = \'345810043118026832\') AS "base")) AS "data"',
      tags: [
        'type:App:id:345810043118026832',
        'type:Component:appId:345810043118026832',
        'type:Element:id',
        'type:PageMeta:id',
      ],
    }

## complex query

> Snapshot 1

    {
      isMutation: false,
      params: [
        '123',
        '456',
        'master',
      ],
      sql: 'SELECT json_build_object(\'app\', (SELECT to_json((SELECT "root" FROM (SELECT "base"."orgId", "base"."id", "base"."branch", "base"."name", "base"."description", "base"."theme", "base"."favicon", "base"."customCSS", "base"."analytics", "base"."customDomain", "join.components.57f9bf6390bb3" AS "components", "join.connections.57f9bf6390bb3" AS "connections", "join.layouts.57f9bf6390bb3" AS "layouts", "join.plugins.57f9bf6390bb3" AS "plugins", "join.schemas.57f9bf6390bb3" AS "schemas", "join.styles.57f9bf6390bb3" AS "styles", "join.workflows.57f9bf6390bb3" AS "workflows") AS "root")) AS "root" FROM (SELECT * FROM "App" WHERE "orgId" = $1::text AND "id" = $2::text AND "branch" = $3::text LIMIT 1) AS "base" LEFT JOIN LATERAL (SELECT coalesce(json_agg(CAST(to_json((SELECT "root" FROM (SELECT "base.Component"."appId", "base.Component"."branch", "base.Component"."id", "base.Component"."branch") AS "root")) AS jsonb) || CASE WHEN "PageMeta.PageMeta"."PageMeta" IS NOT NULL THEN to_jsonb("PageMeta") WHEN "ComponentMeta.ComponentMeta"."ComponentMeta" IS NOT NULL THEN to_jsonb("ComponentMeta") ELSE jsonb_build_object() END), \'[]\') AS "join.components.57f9bf6390bb3" FROM (SELECT * FROM "Component" WHERE "Component"."appId" = "base"."id" AND "Component"."branch" = "base"."branch") AS "base.Component" LEFT JOIN LATERAL (SELECT to_json((SELECT "root" FROM (SELECT "base.Component.PageMeta"."componentId", "base.Component.PageMeta"."branch", "base.Component.PageMeta"."title", "base.Component.PageMeta"."description", "base.Component.PageMeta"."path", "base.Component.PageMeta"."socialImage", "base.Component.PageMeta"."urlParams", "base.Component.PageMeta"."loader", "base.Component.PageMeta"."protection", "base.Component.PageMeta"."maxAge", "base.Component.PageMeta"."sMaxAge", "base.Component.PageMeta"."staleWhileRevalidate") AS "root")) AS "PageMeta" FROM (SELECT * FROM "PageMeta" WHERE "PageMeta"."componentId" = "base.Component"."id" AND "PageMeta"."branch" = "base.Component"."branch" LIMIT 1) AS "base.Component.PageMeta") AS "PageMeta.PageMeta" ON (\'true\') LEFT JOIN LATERAL (SELECT to_json((SELECT "root" FROM (SELECT "base.Component.ComponentMeta"."componentId", "base.Component.ComponentMeta"."branch", "base.Component.ComponentMeta"."title", "join.sources.57f9bf6390bb3" AS "sources", "join.events.57f9bf6390bb3" AS "events") AS "root")) AS "ComponentMeta" FROM (SELECT * FROM "ComponentMeta" WHERE "ComponentMeta"."componentId" = "base.Component"."id" AND "ComponentMeta"."branch" = "base.Component"."branch" LIMIT 1) AS "base.Component.ComponentMeta" LEFT JOIN LATERAL (SELECT coalesce(json_agg(to_json((SELECT "root" FROM (SELECT "base.Component.ComponentMeta.Source"."componentId", "base.Component.ComponentMeta.Source"."branch", "base.Component.ComponentMeta.Source"."id", "base.Component.ComponentMeta.Source"."branch", "base.Component.ComponentMeta.Source"."name", "base.Component.ComponentMeta.Source"."provider", "base.Component.ComponentMeta.Source"."description", "base.Component.ComponentMeta.Source"."template", "base.Component.ComponentMeta.Source"."instanceTemplate", "base.Component.ComponentMeta.Source"."outputType", "base.Component.ComponentMeta.Source"."source", "base.Component.ComponentMeta.Source"."sourceProp", "base.Component.ComponentMeta.Source"."componentId", "base.Component.ComponentMeta.Source"."utilityId", "join.component.db04ca989f055" AS "component", "join.utility.57f9bf6390bb3" AS "utility") AS "root"))), \'[]\') AS "join.sources.57f9bf6390bb3" FROM (SELECT * FROM "Source" WHERE "Source"."componentId" = "base.Component.ComponentMeta"."id" AND "Source"."branch" = "base.Component.ComponentMeta"."branch") AS "base.Component.ComponentMeta.Source" LEFT JOIN LATERAL (SELECT to_json((SELECT "root" FROM (SELECT "base.Component.ComponentMeta.Source.Element"."id", "base.Component.ComponentMeta.Source.Element"."branch", "base.Component.ComponentMeta.Source.Element"."id", "base.Component.ComponentMeta.Source.Element"."branch", "base.Component.ComponentMeta.Source.Element"."name", "base.Component.ComponentMeta.Source.Element"."kind", "base.Component.ComponentMeta.Source.Element"."source", "base.Component.ComponentMeta.Source.Element"."styles", "base.Component.ComponentMeta.Source.Element"."props", "base.Component.ComponentMeta.Source.Element"."order", "base.Component.ComponentMeta.Source.Element"."conditions") AS "root")) AS "join.component.db04ca989f055" FROM (SELECT * FROM "Element" WHERE "Element"."id" = "base.Component.ComponentMeta.Source"."componentId" AND "Element"."branch" = "base.Component.ComponentMeta.Source"."branch" ORDER BY "order" ASC LIMIT 1) AS "base.Component.ComponentMeta.Source.Element") AS "join.component.db04ca989f055.Element" ON (\'true\') LEFT JOIN LATERAL (SELECT to_json((SELECT "root" FROM (SELECT "base.Component.ComponentMeta.Source.Utility"."id", "base.Component.ComponentMeta.Source.Utility"."branch", "base.Component.ComponentMeta.Source.Utility"."id", "base.Component.ComponentMeta.Source.Utility"."branch", "base.Component.ComponentMeta.Source.Utility"."name", "base.Component.ComponentMeta.Source.Utility"."kind", "base.Component.ComponentMeta.Source.Utility"."kindId", "base.Component.ComponentMeta.Source.Utility"."data") AS "root")) AS "join.utility.57f9bf6390bb3" FROM (SELECT * FROM "Utility" WHERE "Utility"."id" = "base.Component.ComponentMeta.Source"."componentId" AND "Utility"."branch" = "base.Component.ComponentMeta.Source"."branch" LIMIT 1) AS "base.Component.ComponentMeta.Source.Utility") AS "join.utility.57f9bf6390bb3.Utility" ON (\'true\')) AS "join.sources.57f9bf6390bb3.Source" ON (\'true\') LEFT JOIN LATERAL (SELECT coalesce(json_agg(to_json((SELECT "root" FROM (SELECT "base.Component.ComponentMeta.Event"."componentMetaId", "base.Component.ComponentMeta.Event"."branch", "base.Component.ComponentMeta.Event"."id", "base.Component.ComponentMeta.Event"."branch", "base.Component.ComponentMeta.Event"."name", "base.Component.ComponentMeta.Event"."label", "base.Component.ComponentMeta.Event"."help", "base.Component.ComponentMeta.Event"."type") AS "root"))), \'[]\') AS "join.events.57f9bf6390bb3" FROM (SELECT * FROM "Event" WHERE "Event"."componentMetaId" = "base.Component.ComponentMeta"."id" AND "Event"."branch" = "base.Component.ComponentMeta"."branch") AS "base.Component.ComponentMeta.Event") AS "join.events.57f9bf6390bb3.Event" ON (\'true\')) AS "ComponentMeta.ComponentMeta" ON (\'true\')) AS "join.components.57f9bf6390bb3.Component" ON (\'true\') LEFT JOIN LATERAL (SELECT coalesce(json_agg(to_json((SELECT "root" FROM (SELECT "base.Connection"."appId", "base.Connection"."branch", "base.Connection"."id", "base.Connection"."branch", "base.Connection"."name", "base.Connection"."kind", "base.Connection"."prodUrl", "join.mutationSchema.57f9bf6390bb3" AS "mutationSchema", "join.endpoints.57f9bf6390bb3" AS "endpoints", "join.headers.57f9bf6390bb3" AS "headers") AS "root"))), \'[]\') AS "join.connections.57f9bf6390bb3" FROM (SELECT * FROM "Connection" WHERE "Connection"."appId" = "base"."id" AND "Connection"."branch" = "base"."branch") AS "base.Connection" LEFT JOIN LATERAL (SELECT to_json((SELECT "root" FROM (SELECT "base.Connection.Schema"."mutationConnectionId", "base.Connection.Schema"."branch", "base.Connection.Schema"."id", "base.Connection.Schema"."branch", "base.Connection.Schema"."schema") AS "root")) AS "join.mutationSchema.57f9bf6390bb3" FROM (SELECT * FROM "Schema" WHERE "Schema"."mutationConnectionId" = "base.Connection"."id" AND "Schema"."branch" = "base.Connection"."branch" LIMIT 1) AS "base.Connection.Schema") AS "join.mutationSchema.57f9bf6390bb3.Schema" ON (\'true\') LEFT JOIN LATERAL (SELECT coalesce(json_agg(to_json((SELECT "root" FROM (SELECT "base.Connection.Endpoint"."connectionId", "base.Connection.Endpoint"."branch", "base.Connection.Endpoint"."id", "base.Connection.Endpoint"."branch", "base.Connection.Endpoint"."name", "base.Connection.Endpoint"."method", "base.Connection.Endpoint"."path", "base.Connection.Endpoint"."responseSchemaId", "join.headers.57f9bf6390bb3" AS "headers", "join.search.57f9bf6390bb3" AS "search") AS "root"))), \'[]\') AS "join.endpoints.57f9bf6390bb3" FROM (SELECT * FROM "Endpoint" WHERE "Endpoint"."connectionId" = "base.Connection"."id" AND "Endpoint"."branch" = "base.Connection"."branch") AS "base.Connection.Endpoint" LEFT JOIN LATERAL (SELECT coalesce(json_agg(to_json((SELECT "root" FROM (SELECT "base.Connection.Endpoint.Header"."parentEndpointId", "base.Connection.Endpoint.Header"."branch", "base.Connection.Endpoint.Header"."id", "base.Connection.Endpoint.Header"."branch", "base.Connection.Endpoint.Header"."key", "base.Connection.Endpoint.Header"."value", "base.Connection.Endpoint.Header"."dynamic") AS "root"))), \'[]\') AS "join.headers.57f9bf6390bb3" FROM (SELECT * FROM "Header" WHERE "Header"."parentEndpointId" = "base.Connection.Endpoint"."id" AND "Header"."branch" = "base.Connection.Endpoint"."branch") AS "base.Connection.Endpoint.Header") AS "join.headers.57f9bf6390bb3.Header" ON (\'true\') LEFT JOIN LATERAL (SELECT coalesce(json_agg(to_json((SELECT "root" FROM (SELECT "base.Connection.Endpoint.Search"."endpointId", "base.Connection.Endpoint.Search"."branch", "base.Connection.Endpoint.Search"."id", "base.Connection.Endpoint.Search"."branch", "base.Connection.Endpoint.Search"."key", "base.Connection.Endpoint.Search"."value", "base.Connection.Endpoint.Search"."dynamic") AS "root"))), \'[]\') AS "join.search.57f9bf6390bb3" FROM (SELECT * FROM "Search" WHERE "Search"."endpointId" = "base.Connection.Endpoint"."id" AND "Search"."branch" = "base.Connection.Endpoint"."branch") AS "base.Connection.Endpoint.Search") AS "join.search.57f9bf6390bb3.Search" ON (\'true\')) AS "join.endpoints.57f9bf6390bb3.Endpoint" ON (\'true\') LEFT JOIN LATERAL (SELECT coalesce(json_agg(to_json((SELECT "root" FROM (SELECT "base.Connection.Header"."parentConnectionId", "base.Connection.Header"."branch", "base.Connection.Header"."id", "base.Connection.Header"."branch", "base.Connection.Header"."key", "base.Connection.Header"."value", "base.Connection.Header"."dynamic") AS "root"))), \'[]\') AS "join.headers.57f9bf6390bb3" FROM (SELECT * FROM "Header" WHERE "Header"."parentConnectionId" = "base.Connection"."id" AND "Header"."branch" = "base.Connection"."branch") AS "base.Connection.Header") AS "join.headers.57f9bf6390bb3.Header" ON (\'true\')) AS "join.connections.57f9bf6390bb3.Connection" ON (\'true\') LEFT JOIN LATERAL (SELECT coalesce(json_agg(to_json((SELECT "root" FROM (SELECT "base.Layout"."appId", "base.Layout"."branch", "base.Layout"."id", "base.Layout"."branch", "base.Layout"."name", "base.Layout"."source", "base.Layout"."kind", "base.Layout"."styles", "base.Layout"."props") AS "root"))), \'[]\') AS "join.layouts.57f9bf6390bb3" FROM (SELECT * FROM "Layout" WHERE "Layout"."appId" = "base"."id" AND "Layout"."branch" = "base"."branch") AS "base.Layout") AS "join.layouts.57f9bf6390bb3.Layout" ON (\'true\') LEFT JOIN LATERAL (SELECT coalesce(json_agg(to_json((SELECT "root" FROM (SELECT "base.Plugin"."appId", "base.Plugin"."branch", "base.Plugin"."instanceId", "base.Plugin"."kind") AS "root"))), \'[]\') AS "join.plugins.57f9bf6390bb3" FROM (SELECT * FROM "Plugin" WHERE "Plugin"."appId" = "base"."id" AND "Plugin"."branch" = "base"."branch") AS "base.Plugin") AS "join.plugins.57f9bf6390bb3.Plugin" ON (\'true\') LEFT JOIN LATERAL (SELECT coalesce(json_agg(to_json((SELECT "root" FROM (SELECT "base.Schema"."appId", "base.Schema"."branch", "base.Schema"."id", "base.Schema"."branch", "base.Schema"."schema") AS "root"))), \'[]\') AS "join.schemas.57f9bf6390bb3" FROM (SELECT * FROM "Schema" WHERE "Schema"."appId" = "base"."id" AND "Schema"."branch" = "base"."branch") AS "base.Schema") AS "join.schemas.57f9bf6390bb3.Schema" ON (\'true\') LEFT JOIN LATERAL (SELECT coalesce(json_agg(to_json((SELECT "root" FROM (SELECT "base.Style"."appId", "base.Style"."branch", "base.Style"."id", "base.Style"."branch", "base.Style"."name", "base.Style"."kind", "base.Style"."styles", "base.Style"."isDefault") AS "root"))), \'[]\') AS "join.styles.57f9bf6390bb3" FROM (SELECT * FROM "Style" WHERE "Style"."appId" = "base"."id" AND "Style"."branch" = "base"."branch") AS "base.Style") AS "join.styles.57f9bf6390bb3.Style" ON (\'true\') LEFT JOIN LATERAL (SELECT coalesce(json_agg(to_json((SELECT "root" FROM (SELECT "base.Workflow"."appId", "base.Workflow"."branch", "base.Workflow"."id", "base.Workflow"."branch", "base.Workflow"."name", "base.Workflow"."args", "join.steps.5b10c9fb026c2" AS "steps") AS "root"))), \'[]\') AS "join.workflows.57f9bf6390bb3" FROM (SELECT * FROM "Workflow" WHERE "Workflow"."appId" = "base"."id" AND "Workflow"."branch" = "base"."branch") AS "base.Workflow" LEFT JOIN LATERAL (SELECT coalesce(json_agg(to_json((SELECT "root" FROM (SELECT "base.Workflow.Step"."workflowId", "base.Workflow.Step"."branch", "base.Workflow.Step"."id", "base.Workflow.Step"."branch", "base.Workflow.Step"."parentId", "base.Workflow.Step"."kind", "base.Workflow.Step"."kindId", "base.Workflow.Step"."data", "base.Workflow.Step"."order") AS "root"))), \'[]\') AS "join.steps.5b10c9fb026c2" FROM (SELECT * FROM "Step" WHERE "Step"."workflowId" = "base.Workflow"."id" AND "Step"."branch" = "base.Workflow"."branch" ORDER BY "order" ASC) AS "base.Workflow.Step") AS "join.steps.5b10c9fb026c2.Step" ON (\'true\')) AS "join.workflows.57f9bf6390bb3.Workflow" ON (\'true\'))) AS "data"',
      tags: [
        'type:App:branch:master',
        'type:App:id:456',
        'type:App:orgId:123',
        'type:Component:branch',
        'type:Component:branch:master',
        'type:ComponentMeta',
        'type:Connection:branch',
        'type:Connection:branch:master',
        'type:Element',
        'type:Endpoint:branch',
        'type:Endpoint:branch:master',
        'type:Event',
        'type:Header:branch',
        'type:Header:branch:master',
        'type:Layout:branch',
        'type:Layout:branch:master',
        'type:PageMeta',
        'type:Plugin:branch',
        'type:Plugin:branch:master',
        'type:Schema:branch',
        'type:Schema:branch:master',
        'type:Search:branch',
        'type:Search:branch:master',
        'type:Source',
        'type:Step:branch',
        'type:Step:branch:master',
        'type:Style:branch',
        'type:Style:branch:master',
        'type:Utility',
        'type:Workflow:branch',
        'type:Workflow:branch:master',
      ],
    }
